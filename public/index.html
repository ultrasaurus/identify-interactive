<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="jcrop/js/jquery.Jcrop.min.js"></script>

  <link rel="stylesheet" href="jcrop/css/jquery.Jcrop.css" type="text/css" />

  <script language="Javascript">
      var base_url = "http://ids.si.edu/ids/deliveryService?max=500&id=http://collections.nmnh.si.edu/search/botany/search.php?irn=10334758"

      // c.x, c.y, c.x2, c.y2, c.w, c.h
      function jcropSelect(c) {
        var cloudinary_prefix = "http://res.cloudinary.com/demo/image/fetch/";
        var cloudinary_params = "x_"+ c.x*2 +",y_"+ c.y*2 +
                                ",w_"+ c.w*2 +",h_"+ c.h*2 +",c_crop/";
        //var source_url = base_url + "%26width=" + 768*2 + "%26height=" + 1024*2 + "%26action=10";
        source_url = "http://identify-interactive.herokuapp.com/botany.jpg";
        var img_url = cloudinary_prefix + cloudinary_params + source_url 
        $("#action").append("<img src='"+img_url+"'/>");
      }


      $(document).ready(function() {
        console.log('document ready');
        $('#target').Jcrop({
          onSelect: jcropSelect
        });
      });
  </script>

  <style>
    #source, #action {
      float: left;
      padding: 10px;
    }
    .actions {
    }
  </style>

    
  
</head>

<body>
<div id="source">
  <!--  width="1024" height="1286" -->
  <img width="512" height="643"
    src="http://identify-interactive.herokuapp.com/botany.jpg" id="target" />
</div>
<div id="action">
  <p>Select the barcode OR <button>I don't see one</button></p>
</div>
</body>
</html>
